<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>valentine.exe</title>
  <style>
    :root {
      --bg: #0b1020;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --accent: #ff4d8d;
      --accent2: #7c5cff;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: var(--sans);
      color: var(--text);
      background: radial-gradient(1200px 900px at 15% 20%, rgba(124,92,255,.35), transparent 60%),
                  radial-gradient(1000px 800px at 85% 30%, rgba(255,77,141,.30), transparent 55%),
                  radial-gradient(900px 700px at 40% 90%, rgba(70,255,166,.18), transparent 55%),
                  var(--bg);
      overflow: hidden;
    }

    .bg {
      position: fixed; inset: 0;
      background-image: none;
      background-size: cover;
      background-position: center;
      filter: blur(12px) saturate(1.15) brightness(.65);
      transform: scale(1.08);
      opacity: .55;
      pointer-events: none;
    }

    .wrap {
      position: relative;
      height: 100%;
      display: grid;
      place-items: center;
      padding: 22px;
    }

    .card {
      width: min(720px, 100%);
      background: linear-gradient(180deg, var(--card2), var(--card));
      border: 1px solid rgba(255,255,255,.14);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      backdrop-filter: blur(14px);
      position: relative;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      position: relative;
      z-index: 3;
    }

    .dots { display: flex; gap: 8px; }
    .dot { width: 10px; height: 10px; border-radius: 999px; opacity: .85; }
    .dot.red { background: #ff5b5b; }
    .dot.yellow { background: #ffd05b; }
    .dot.green { background: #46ffa6; }

    .title {
      font-family: var(--mono);
      font-size: 13px;
      opacity: .9;
    }

    .content {
      padding: 22px;
      display: grid;
      gap: 18px;
      position: relative;
      z-index: 2;
      opacity: 1;
      transform: translateY(0);
      transition: opacity .9s ease, transform .9s ease;
    }

    .headline { display: grid; gap: 8px; }
    h1 {
      margin: 0;
      font-size: clamp(22px, 3vw, 30px);
      letter-spacing: -0.02em;
    }
    .sub {
      margin: 0;
      color: var(--muted);
      line-height: 1.45;
      font-size: 15px;
    }

    /* ‚úÖ Responsive banner that NEVER crops the GIF */
    .gif-banner{
      width:100%;
      height: min(260px, 28vh);
      object-fit: contain;
      object-position: center;
      background: rgba(0,0,0,.25);
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 28px rgba(0,0,0,.20);
      display:block;
    }

    .terminal {
      background: rgba(0,0,0,.32);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 14px 14px 12px;
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.55;
      position: relative;
      overflow: hidden;
    }
    .terminal:before {
      content: "";
      position: absolute; inset: -120px -80px;
      background: radial-gradient(circle at 30% 20%, rgba(255,77,141,.20), transparent 55%),
                  radial-gradient(circle at 70% 40%, rgba(124,92,255,.20), transparent 55%);
      filter: blur(18px);
      opacity: .85;
      pointer-events: none;
    }
    .term-line { position: relative; }
    .prompt { color: rgba(70,255,166,.95); }
    .cmd { color: rgba(255,255,255,.92); }
    .hint { color: rgba(255,255,255,.65); }

    .cta { display: grid; gap: 12px; position: relative; }
    .question { font-size: 16px; color: rgba(255,255,255,.88); }

    .btnrow {
      position: relative;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      padding-bottom: 6px;
      min-height: 56px;
    }

    button {
      border: 0;
      cursor: pointer;
      padding: 12px 16px;
      border-radius: 14px;
      font-weight: 700;
      letter-spacing: .01em;
      color: rgba(255,255,255,.94);
      transition: transform .08s ease, filter .12s ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      position: relative;
      z-index: 4;
    }
    button:active { transform: scale(.98); }

    #yesBtn {
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      box-shadow: 0 12px 35px rgba(255,77,141,.18);
    }
    #yesBtn:hover { filter: brightness(1.07); }

    /* Floating "No" button */
    #noBtn {
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.16);
      position: absolute;
      left: 0;
      top: 0;
      z-index: 10;
    }
    #noBtn:hover { filter: brightness(1.06); }

    /* ‚úÖ Roam ONLY inside the CTA (question area) */
    #noLayer {
      position: absolute;
      inset: 0;
      z-index: 9;
      pointer-events: none;
    }
    #noLayer button { pointer-events: auto; }

    .small { font-size: 12px; color: rgba(255,255,255,.62); margin-top: 8px; }

    .footer {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
      color: rgba(255,255,255,.60);
      font-size: 12px;
      font-family: var(--mono);
      border-top: 1px solid rgba(255,255,255,.10);
      padding: 14px 16px;
      position: relative;
      z-index: 3;
    }

    .pill {
      border: 1px solid rgba(255,255,255,.18);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
    }

    .success {
      display: none;
      padding: 34px 22px 26px;
      text-align: center;
      gap: 16px;
      position: relative;
      z-index: 2;
      opacity: 0;
      transform: translateY(12px);
      transition: opacity 1s ease, transform 1s ease;
    }
    .success h2 { margin: 0; font-size: clamp(22px, 3vw, 34px); letter-spacing: -0.02em; }
    .success p { margin: 0; color: rgba(255,255,255,.78); line-height: 1.55; }
    .big-heart { font-size: 44px; filter: drop-shadow(0 12px 30px rgba(255,77,141,.25)); }

    /* Keep canvas but we won't use it (safe) */
    canvas#confetti { position: fixed; inset: 0; pointer-events: none; }

    /* ‚úÖ Lightweight fireworks GIF overlay (no lag) */
    #fxOverlay{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      z-index: 999;
    }
    #fxOverlay img{
      width: min(820px, 92vw);
      height: auto;
      border-radius: 18px;
      opacity: 0.92;
      filter: drop-shadow(0 18px 55px rgba(0,0,0,.45));
    }
  </style>
</head>

<body>
  <div class="bg" id="bg"></div>
  <canvas id="confetti"></canvas>

  <!-- Fireworks overlay -->
  <div id="fxOverlay" aria-hidden="true">
    <img id="fxGif" src="" alt="">
  </div>

  <div class="wrap">
    <div class="card" id="card">
      <div class="topbar">
        <div class="dots" aria-hidden="true">
          <div class="dot red"></div>
          <div class="dot yellow"></div>
          <div class="dot green"></div>
        </div>
        <div class="title">valentine.exe ‚Äî stable build</div>
      </div>

      <div class="content" id="main">
        <div class="headline">
          <h1>Hey <span id="herName">love</span>, I shipped a feature üöÄ</h1>
          <p class="sub">
            It passed QA (dating phase), survived prod (our real life ups & downs), and the only remaining requirement is your approval.
          </p>
        </div>

        <img class="gif-banner"
             src="https://media.giphy.com/media/63MopWVJ7BcWM4SjXO/giphy.gif"
             alt="cat kiss" />

        <div class="terminal" aria-label="terminal">
          <div class="term-line"><span class="prompt">$</span> <span class="cmd">git checkout -b be-my-valentine</span></div>
          <div class="term-line"><span class="prompt">$</span> <span class="cmd">npm run ask</span></div>
          <div class="term-line"><span class="hint" id="typed"></span><span class="hint" id="cursor">‚ñç</span></div>
        </div>

        <div class="cta" id="ctaArea">
          <div id="noLayer">
            <button id="noBtn">No üôÉ</button>
          </div>

          <div class="question">Would you like to be my Valentine?</div>

          <div class="btnrow">
            <button id="yesBtn">Yes üíñ</button>
          </div>

          <div class="small">P.S. The ‚ÄúNo‚Äù option is‚Ä¶ under active maintenance.</div>
        </div>
      </div>

      <div class="success" id="success">
        <div class="big-heart">üíò</div>
        <h2>Merge approved.</h2>
        <p>
          Thank you for being my Valentine ‚Äî our first one together.<br />
          I‚Äôm stupid grateful to have you.
        </p>
        <p class="small">
          <span class="pill">status: committed</span>
          <span class="pill">branch: us</span>
          <span class="pill">deploy: tonight</span>
        </p>
      </div>

      <div class="footer">
        <div class="pill" id="buildTag">build: v1.0.0</div>
        <div><span class="pill">made with ‚ù§Ô∏è + a little vibe coding + html</span></div>
      </div>
    </div>
  </div>

  <script>
    const HER_NAME = "Zohal";
    const BG_IMAGE_URL = "https://media.giphy.com/media/63MopWVJ7BcWM4SjXO/giphy.gif";
    const SUCCESS_TITLE = "Merge approved.";
    const SUCCESS_TEXT = "Thank you for being my Valentine ‚Äî our first one together.\nI‚Äôm stupid grateful to have you.";

    // ‚úÖ Fireworks GIF (used as SUCCESS BACKGROUND)
    const FIREWORKS_GIF_URL = "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExOG94dHJwMjIzaDJqeGVnbnphMnE4dHFhcTBoMTRtNXl6NHF1eHJ5YiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/HbWB5ayYihkBy/giphy.gif";

    document.getElementById("herName").textContent = (HER_NAME || "love");
    const bg = document.getElementById("bg");
    const bannerGif = document.querySelector(".gif-banner");
    if (BG_IMAGE_URL) bg.style.backgroundImage = `url('${BG_IMAGE_URL}')`;

    const typedEl = document.getElementById("typed");
    const cursorEl = document.getElementById("cursor");

    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const noLayer = document.getElementById("noLayer");
    const ctaArea = document.getElementById("ctaArea");

    const main = document.getElementById("main");
    const success = document.getElementById("success");

    // Fireworks overlay elements
    const fxOverlay = document.getElementById("fxOverlay");
    const fxGif = document.getElementById("fxGif");

    const KEY = "valentineAccepted";
    if (localStorage.getItem(KEY) === "yes") showSuccess(false);

    // Dev reset: press R to reset (remove if you want)
    document.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "r") {
        localStorage.removeItem(KEY);
        location.reload();
      }
    });

    const message = `Initializing romantic-protocol...\nRunning tests: ‚úÖ\nFinal prompt: ${HER_NAME || "love"}, will you be my Valentine?`;
    typewriter(message, typedEl, 18);

    function typewriter(text, el, speed) {
      let i = 0;
      const full = text.split("\n").join("\n");
      const tick = () => {
        i++;
        el.textContent = full.slice(0, i);
        if (i < full.length) setTimeout(tick, speed);
        else setInterval(() => cursorEl.style.opacity = (cursorEl.style.opacity === "0" ? "1" : "0"), 520);
      };
      tick();
    }

    function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

    // Keep it inside CTA and away from Yes area
    const EDGE_PAD = 8;
    const SAFE_RADIUS = 150;

    function overlapsRect(a, b) {
      return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
    }

    function placeNoInCtaAwayFromYes() {
      const layerRect = ctaArea.getBoundingClientRect();
      const yesRect = yesBtn.getBoundingClientRect();

      const btnW = noBtn.offsetWidth;
      const btnH = noBtn.offsetHeight;

      const maxX = layerRect.width - btnW - EDGE_PAD;
      const maxY = layerRect.height - btnH - EDGE_PAD;

      const tries = 50;
      for (let i = 0; i < tries; i++) {
        const x = clamp(EDGE_PAD + Math.random() * maxX, EDGE_PAD, maxX);
        const y = clamp(EDGE_PAD + Math.random() * maxY, EDGE_PAD, maxY);

        const candidate = {
          left: layerRect.left + x,
          top: layerRect.top + y,
          right: layerRect.left + x + btnW,
          bottom: layerRect.top + y + btnH
        };

        if (overlapsRect(candidate, yesRect)) continue;

        const cx = (candidate.left + candidate.right) / 2;
        const cy = (candidate.top + candidate.bottom) / 2;
        const yx = (yesRect.left + yesRect.right) / 2;
        const yy = (yesRect.top + yesRect.bottom) / 2;
        if (Math.hypot(cx - yx, cy - yy) < SAFE_RADIUS) continue;

        noBtn.style.left = `${x}px`;
        noBtn.style.top = `${y}px`;
        return;
      }

      noBtn.style.left = `${EDGE_PAD}px`;
      noBtn.style.top = `${EDGE_PAD}px`;
    }

    document.addEventListener("mousemove", (e) => {
      if (localStorage.getItem(KEY) === "yes") return;
      const btnRect = noBtn.getBoundingClientRect();
      if (distanceToRect(e.clientX, e.clientY, btnRect) < 90) placeNoInCtaAwayFromYes();
    }, { passive: true });

    document.addEventListener("touchstart", (e) => {
      if (localStorage.getItem(KEY) === "yes") return;
      const t = e.touches[0];
      if (!t) return;
      const btnRect = noBtn.getBoundingClientRect();
      if (distanceToRect(t.clientX, t.clientY, btnRect) < 110) placeNoInCtaAwayFromYes();
    }, { passive: true });

    noBtn.addEventListener("click", () => {
      placeNoInCtaAwayFromYes();
      flashBuildTag("Nice try üòà", true);
    });

    // ‚úÖ Lightweight GIF overlay (no lag)
    function cacheBust(url){
      const sep = url.includes("?") ? "&" : "?";
      return url + sep + "v=" + Date.now();
    }

    // (Overlay function kept for safety but no longer used;
    //  we now switch the whole background to the fireworks GIF instead)
    function playFireworksGif(durationMs = 2400){
      if (!FIREWORKS_GIF_URL) return;
      fxGif.src = cacheBust(FIREWORKS_GIF_URL);
      fxOverlay.style.display = "flex";
      setTimeout(() => {
        fxOverlay.style.display = "none";
        fxGif.src = "";
      }, durationMs);
    }

    yesBtn.addEventListener("click", () => {
      localStorage.setItem(KEY, "yes");

      // Start smooth transition: fade & slide main out
      noLayer.style.display = "none";
      main.style.opacity = "0";
      main.style.transform = "translateY(-10px)";

      // Slight delay to let the fade-out start, then swap views
      setTimeout(() => {
        showSuccess(true);
      }, 650);
    });

    function showSuccess(animate = true) {
      // Update success content
      success.querySelector("h2").textContent = SUCCESS_TITLE;
      success.querySelector("p").innerHTML = SUCCESS_TEXT.replaceAll("\n", "<br/>");

      // üî• Switch background to fireworks and hide the cat banner
      if (FIREWORKS_GIF_URL) {
        bg.style.backgroundImage = `url('${FIREWORKS_GIF_URL}')`;
      }
      if (bannerGif) {
        bannerGif.style.display = "none";
      }

      // Show success and animate it in
      main.style.display = "none";
      success.style.display = "grid";
      requestAnimationFrame(() => {
        success.style.opacity = "1";
        success.style.transform = "translateY(0)";
      });

      if (animate) flashBuildTag("build: ‚ù§Ô∏è shipped", false);
    }

    function flashBuildTag(text, danger) {
      const el = document.getElementById("buildTag");
      const original = el.textContent;
      el.textContent = text;
      el.style.borderColor = danger ? "rgba(255,91,91,.55)" : "rgba(70,255,166,.55)";
      el.style.background = danger ? "rgba(255,91,91,.12)" : "rgba(70,255,166,.10)";
      setTimeout(() => {
        el.textContent = original;
        el.style.borderColor = "rgba(255,255,255,.18)";
        el.style.background = "rgba(255,255,255,.06)";
      }, 950);
    }

    function distanceToRect(x, y, rect) {
      const dx = Math.max(rect.left - x, 0, x - rect.right);
      const dy = Math.max(rect.top - y, 0, y - rect.bottom);
      return Math.sqrt(dx*dx + dy*dy);
    }

    requestAnimationFrame(placeNoInCtaAwayFromYes);
    window.addEventListener("resize", () => {
      if (localStorage.getItem(KEY) !== "yes") placeNoInCtaAwayFromYes();
    }, { passive: true });
  </script>
</body>
</html>
